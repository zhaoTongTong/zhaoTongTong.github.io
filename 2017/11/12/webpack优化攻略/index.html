<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="webpack," />










<meta name="description" content="webpackç›¸å…³åˆ†äº«webpackå¸¸è§„é…ç½®webpack.config.jsï¼š 12345678entry: &quot;./app/entry&quot;,  //å•é¡µé¢å•ä¸€å…¥å£entry: [&quot;./app/entry1&quot;, &quot;./app/entry2&quot;],  //å•é¡µé¢å¤šå…¥å£entry: &amp;#123;    //å¤šé¡µé¢å¤šå…¥å£  a: &quot;./app/entry-a&quot;,  b: [&quot;./app/entry-b1&quot;,">
<meta name="keywords" content="webpack">
<meta property="og:type" content="article">
<meta property="og:title" content="webpackç›¸å…³åˆ†äº«">
<meta property="og:url" content="http://yoursite.com/2017/11/12/webpackä¼˜åŒ–æ”»ç•¥/index.html">
<meta property="og:site_name" content="å§‘å‡‰æ˜¯ç¨‹åºåª›">
<meta property="og:description" content="webpackç›¸å…³åˆ†äº«webpackå¸¸è§„é…ç½®webpack.config.jsï¼š 12345678entry: &quot;./app/entry&quot;,  //å•é¡µé¢å•ä¸€å…¥å£entry: [&quot;./app/entry1&quot;, &quot;./app/entry2&quot;],  //å•é¡µé¢å¤šå…¥å£entry: &amp;#123;    //å¤šé¡µé¢å¤šå…¥å£  a: &quot;./app/entry-a&quot;,  b: [&quot;./app/entry-b1&quot;,">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/img/2.pic.jpg">
<meta property="og:image" content="http://yoursite.com/img/6.pic_hd.jpg">
<meta property="og:image" content="http://yoursite.com/img/7.pic_hd.jpg">
<meta property="og:image" content="http://yoursite.com/img/8.pic_hd.jpg">
<meta property="og:updated_time" content="2017-12-07T07:01:35.653Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="webpackç›¸å…³åˆ†äº«">
<meta name="twitter:description" content="webpackç›¸å…³åˆ†äº«webpackå¸¸è§„é…ç½®webpack.config.jsï¼š 12345678entry: &quot;./app/entry&quot;,  //å•é¡µé¢å•ä¸€å…¥å£entry: [&quot;./app/entry1&quot;, &quot;./app/entry2&quot;],  //å•é¡µé¢å¤šå…¥å£entry: &amp;#123;    //å¤šé¡µé¢å¤šå…¥å£  a: &quot;./app/entry-a&quot;,  b: [&quot;./app/entry-b1&quot;,">
<meta name="twitter:image" content="http://yoursite.com/img/2.pic.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/11/12/webpackä¼˜åŒ–æ”»ç•¥/"/>





  <title>webpackç›¸å…³åˆ†äº« | å§‘å‡‰æ˜¯ç¨‹åºåª›</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">å§‘å‡‰æ˜¯ç¨‹åºåª›</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/12/webpackä¼˜åŒ–æ”»ç•¥/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ztt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å§‘å‡‰æ˜¯ç¨‹åºåª›">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">webpackç›¸å…³åˆ†äº«</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-11-12T14:23:12+08:00">
                2017-11-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="webpackç›¸å…³åˆ†äº«"><a href="#webpackç›¸å…³åˆ†äº«" class="headerlink" title="webpackç›¸å…³åˆ†äº«"></a>webpackç›¸å…³åˆ†äº«</h1><h2 id="webpackå¸¸è§„é…ç½®"><a href="#webpackå¸¸è§„é…ç½®" class="headerlink" title="webpackå¸¸è§„é…ç½®"></a>webpackå¸¸è§„é…ç½®</h2><p>webpack.config.jsï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">entry: <span class="string">"./app/entry"</span>,  <span class="comment">//å•é¡µé¢å•ä¸€å…¥å£</span></span><br><span class="line"></span><br><span class="line">entry: [<span class="string">"./app/entry1"</span>, <span class="string">"./app/entry2"</span>],  <span class="comment">//å•é¡µé¢å¤šå…¥å£</span></span><br><span class="line"></span><br><span class="line">entry: &#123;    <span class="comment">//å¤šé¡µé¢å¤šå…¥å£</span></span><br><span class="line">  a: <span class="string">"./app/entry-a"</span>,</span><br><span class="line">  b: [<span class="string">"./app/entry-b1"</span>, <span class="string">"./app/entry-b2"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">  path: path.resolve(__dirname, <span class="string">"dist"</span>),  <span class="comment">//è¾“å‡ºæ–‡ä»¶çš„ç›®å½•è·¯å¾„ï¼Œå¿…é¡»æ˜¯ç»å¯¹è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">  filename: <span class="string">'bundle.js'</span>,  <span class="comment">//å•é¡µé¢è¾“å‡ºchunkçš„æ–‡ä»¶å</span></span><br><span class="line"></span><br><span class="line">  filename: <span class="string">'[name].js'</span>,  <span class="comment">//å¤šé¡µé¢è¾“å‡ºchunksçš„æ–‡ä»¶åæ¨¡æ¿</span></span><br><span class="line"></span><br><span class="line">  publicPath: process.env.NODE_ENV === <span class="string">'production'</span></span><br><span class="line">    ? config.build.assetsPublicPath</span><br><span class="line">    : config.dev.assetsPublicPath</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">resolve: &#123;</span><br><span class="line">  modules: [   <span class="comment">// è®¾ç½®æŸ¥æ‰¾æ¨¡å—çš„ç›®å½•</span></span><br><span class="line">    path.resolve(__dirname, <span class="string">"node_modules"</span>),</span><br><span class="line">    path.resolve(__dirname, <span class="string">"src"</span>)</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  extensions: [<span class="string">".js"</span>, <span class="string">".vue"</span>, <span class="string">".json"</span>, <span class="string">".css"</span>],     <span class="comment">// é…ç½®çœç•¥çš„æ‰©å±•å</span></span><br><span class="line"></span><br><span class="line">  alias: &#123;    <span class="comment">// æ¨¡å—åˆ«ååˆ—è¡¨</span></span><br><span class="line">    <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.esm.js'</span>,</span><br><span class="line">    <span class="string">'@'</span>: resolve(<span class="string">'src'</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">externals: &#123;</span><br><span class="line">  <span class="string">'react'</span>: <span class="string">'window.React'</span>   <span class="comment">//é…ç½®æ’é™¤ä¾èµ–ï¼Œæ‰“åŒ…æ—¶å¿½ç•¥reactç›´æ¥æŒ‡å‘å¤–éƒ¨ä¾èµ–çš„window.Reactå˜é‡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">  rules: [    <span class="comment">//é…ç½®æ¨¡å—è§„åˆ™</span></span><br><span class="line">    test: <span class="regexp">/\.js$/</span>,    <span class="comment">//åŒ¹é…æ–‡ä»¶æ­£åˆ™</span></span><br><span class="line">    loader: <span class="string">'babel-loader'</span>,   <span class="comment">//ä½¿ç”¨çš„ loader</span></span><br><span class="line">    include: [resolve(<span class="string">'src'</span>), resolve(<span class="string">'test'</span>)],   <span class="comment">//å¿…é¡»åŒ¹é…çš„ç›®å½•</span></span><br><span class="line">    exclude: resolve(<span class="string">'src/lib'</span>)   <span class="comment">//å¿…é¡»æ’é™¤çš„ç›®å½•</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">  ...æ ¹æ®æ’ä»¶çš„å…·ä½“ç”¨æ³•é…ç½®</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="webpackä¼˜åŒ–æ”»ç•¥"><a href="#webpackä¼˜åŒ–æ”»ç•¥" class="headerlink" title="webpackä¼˜åŒ–æ”»ç•¥"></a>webpackä¼˜åŒ–æ”»ç•¥</h2><h3 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h3><p>å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨æœ€å¤šçš„æ–¹å¼å°±æ˜¯HMR( hot module replacement )ï¼Œçƒ­æ›¿æ¢çš„æ¦‚å¿µæ˜¯æŒ‡ webpack ä¼šç›‘å¬æºä»£ç çš„ä¿®æ”¹ï¼Œå½“ç›‘å¬æ–‡ä»¶æ”¹å˜æ—¶ï¼Œä¼šä»¥ json æ•°æ®çš„å½¢å¼é€šçŸ¥å®¢æˆ·ç«¯è¿›è¡Œæ£€æŸ¥æ›´æ–°ï¼Œå®¢æˆ·ç«¯å‘é€è¯·æ±‚è·å–æ›´æ–°åçš„ä»£ç å¹¶åˆå¹¶åˆ°å½“å‰ä»£ç ä¸­ï¼Œå®ç°ä¸åˆ·æ–°é¡µé¢çš„æƒ…å†µä¸‹è¿›è¡Œå±€éƒ¨æ›´æ–°ã€‚</p>
<h4 id="HMRä½¿ç”¨æ–¹å¼"><a href="#HMRä½¿ç”¨æ–¹å¼" class="headerlink" title="HMRä½¿ç”¨æ–¹å¼"></a>HMRä½¿ç”¨æ–¹å¼</h4><p>hmr çš„å·¥ä½œæµç¨‹å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="../../../../img/2.pic.jpg" alt="hmr"></p>
<ul>
<li>æœåŠ¡å™¨ç«¯ç›¸å…³é…ç½® dev-server.js:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> devMiddleware = <span class="built_in">require</span>(<span class="string">'webpack-dev-middleware'</span>)(compiler, &#123;</span><br><span class="line">  publicPath: webpackConfig.output.publicPath,</span><br><span class="line">  quiet: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hotMiddleware = <span class="built_in">require</span>(<span class="string">'webpack-hot-middleware'</span>)(compiler, &#123;</span><br><span class="line">  log: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.use(devMiddleware)</span><br><span class="line"></span><br><span class="line">app.use(hotMiddleware)</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šä»£ç å®‰è£…ä¸¤ä¸ªç›¸å…³çš„ä¸­é—´ä»¶ï¼Œå¹¶é…ç½®å‚æ•°ï¼Œå¯¹åº”æµç¨‹å›¾ä¸­çš„ bundle-server å’Œ hmr-server ã€‚bundle-server æ˜¯ä¸€ä¸ªé™æ€æœåŠ¡å™¨ï¼Œç»™å®¢æˆ·ç«¯æä¾› webpack æ‰“åŒ…ç¼–è¯‘å®Œçš„æ–‡ä»¶ï¼Œhmr-server æ˜¯è´Ÿè´£è·Ÿ hmr runtime é€šä¿¡çš„æœåŠ¡å™¨ï¼Œç›‘å¬ webpack çš„ä»»åŠ¡ç‚¹ç„¶åé€šçŸ¥å®¢æˆ·ç«¯ runtime è¿›è¡Œæ›´æ–°ï¼Œruntime å†å‘é™æ€æœåŠ¡å™¨è¯·æ±‚æ‰“åŒ…å¥½çš„æ›´æ–°èµ„æºæ’å…¥é¡µé¢ã€‚</p>
<ul>
<li>å®¢æˆ·ç«¯ç›¸å…³é…ç½®ï¼šwebpack.dev.conf.js:</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å°† hmr runtime åµŒå…¥æ‰€æœ‰å…¥å£è¿›è¡Œæ‰“åŒ…</span></span><br><span class="line"><span class="built_in">Object</span>.keys(baseWebpackConfig.entry).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">name</span>) </span>&#123;</span><br><span class="line">  baseWebpackConfig.entry[name] = [<span class="string">'./build/dev-client'</span>].concat(baseWebpackConfig.entry[name])</span><br><span class="line">&#125;)</span><br><span class="line">plugins: [</span><br><span class="line">	...</span><br><span class="line">   	<span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>å®¢æˆ·ç«¯éœ€è¦å°† webpack-hot-middleware/client æ–‡ä»¶æ”¾è¿› entry ä¸­è¿›è¡Œæ‰“åŒ…ï¼Œä¹Ÿå°±æ˜¯æµç¨‹å›¾ä¸­çš„ hmr runtime åµŒå…¥æµè§ˆå™¨ä¸­ã€‚ç„¶åå†å®ä¾‹åŒ–ä¸€ä¸ªçƒ­æ›¿æ¢æ’ä»¶å³å¯ã€‚</p>
<h4 id="æºç åˆ†æ"><a href="#æºç åˆ†æ" class="headerlink" title="æºç åˆ†æ"></a>æºç åˆ†æ</h4><ul>
<li>æµè§ˆå™¨ç«¯ (hmr runtime) </li>
</ul>
<p>client.js:<br><img src="../../../../img/6.pic_hd.jpg" alt="client.js"><br>æˆ‘ä»¬æ¥å…³æ³¨å‡ æ®µé‡ç‚¹ä»£ç ï¼Œé¦–å…ˆåœ¨ init() ä¸­å¯åŠ¨äº†ä¸€ä¸ªEventSourceæœåŠ¡å™¨æ¨é€äº‹ä»¶ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“æ¥æ”¶åˆ°æœåŠ¡å™¨æ¨é€è¿‡æ¥çš„æ¶ˆæ¯æ—¶ï¼Œæ‰§è¡Œ handleMessage å‡½æ•°ï¼Œè¿™é‡Œæ˜¯æŠŠæ‰€æœ‰çš„è®¢é˜…è€…å›è°ƒå‡½æ•°éå†æ‰§è¡Œï¼Œå…¶ä¸­å‚æ•° event ä¸ºæœåŠ¡å™¨æ¨é€è¿‡æ¥çš„æ•°æ®ã€‚å›è°ƒå‡½æ•°æ˜¯é€šè¿‡ return å‡ºå»çš„ addMessageListener æ–¹æ³•è¿›è¡Œæ³¨å†Œçš„ã€‚å¯ä»¥çœ‹åˆ°åœ¨ connect å‡½æ•°ä¸­æ³¨å†Œäº†ä¸€ä¸ª handleMessage å›è°ƒï¼Œè¯¥å‡½æ•°åˆ¤æ–­äº†æœåŠ¡å™¨æ¨é€çš„æ•°æ®ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªğŸ’—çš„ unicode åˆ™ç›´æ¥è¿”å›ï¼Œè‹¥ä¸æ˜¯åˆ™ä¼šè°ƒç”¨ä¸€ä¸ª processMessage æ–¹æ³•ã€‚</p>
<p>è¿™é‡Œè§£é‡Šä¸€ä¸‹ğŸ’—çš„ä½œç”¨ï¼Œç”±äºEventSourceæ˜¯ä¸€ä¸ª stream æ•°æ®æµï¼Œhmr æœ‰ä¸€ä¸ªåˆ¤æ–­è¿æ¥æ–­å¼€çš„ç­–ç•¥ï¼Œå³å½“å‰æ¥å—æ¶ˆæ¯çš„æ—¶é—´ä¸ä¸Šä¸€æ¬¡çš„æ—¶é—´é—´éš”20sï¼ˆé»˜è®¤ï¼‰ä»¥ä¸Šå³ä¸ºæ–­å¼€ï¼Œæ‰€ä»¥ä¸ºäº†ä¿æŒè¿æ¥ï¼ŒæœåŠ¡å™¨ä¼šæ¯10sæ¨é€ä¸€ä¸ªğŸ’—åˆ°æµè§ˆå™¨ã€‚</p>
<p>å›åˆ°åˆšæ‰çš„ä»£ç ï¼Œæˆ‘ä»¬å‘ç°è°ƒç”¨äº†ä¸€ä¸ª processMessage æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¦‚ä¸‹å›¾ï¼š<br><img src="../../../../img/7.pic_hd.jpg" alt="process"><br>æœåŠ¡å™¨æ¨é€çš„æ•°æ®è¿›å…¥è¯¥å‡½æ•°åï¼Œåˆ¤æ–­ action å­—æ®µçš„å€¼ï¼Œå½“å€¼ä¸º built æˆ– sync æ—¶ï¼Œåœ¨æ²¡æœ‰é”™è¯¯çš„æƒ…å†µä¸‹ä¼šæ‰§è¡Œ processUpdate å‡½æ•°ï¼Œè‹¥ action å…¶ä»–ç±»å‹åˆ™æ‰§è¡Œè‡ªå®šä¹‰çš„æ–¹æ³•ï¼ˆcustomHandlerï¼‰ã€‚ä¸‹é¢è¿›å…¥ processUpdate é‡Œçš„æ ¸å¿ƒä»£ç çœ‹çœ‹ã€‚<br><img src="../../../../img/8.pic_hd.jpg" alt="processUpdate"><br>è¿™ä¸ª check å‡½æ•°å°±æ˜¯å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯æ£€æŸ¥æ¨¡å—æ›´æ–°çš„ä»£ç ï¼Œä¸»è¦ç”¨äº†module.hot apié‡Œçš„ apply å’Œ check æ–¹æ³•ã€‚æ­¤å¤„æ£€æŸ¥æ›´æ–°åå¾—åˆ°æ›´æ–°çš„æ¨¡å—ï¼Œå¦‚æœæ¨¡å—æ— æ³•è¢«æ›´æ–°åˆ™æ‰§è¡Œ performReload å‡½æ•°å¼ºåˆ¶åˆ·æ–°é¡µé¢ã€‚å¦‚æœæœ‰å¯æ›´æ–°çš„æ¨¡å—ï¼Œåˆ™å°†ä»é™æ€æœåŠ¡å™¨ä¸Šè¯·æ±‚æ¥çš„ js æ–‡ä»¶æ’å…¥é¡µé¢ã€‚è‡³æ­¤å®¢æˆ·ç«¯çš„æµç¨‹åˆ†æçš„å·®ä¸å¤šäº†ã€‚</p>
<ul>
<li>æœåŠ¡å™¨ç«¯</li>
</ul>
<p>webpack-hot-middleware/middleware.js:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç›‘å¬webpackçš„ä¸¤ä¸ªä»»åŠ¡ç‚¹å¹¶publishç›¸å…³æ•°æ®</span></span><br><span class="line">compiler.plugin(<span class="string">"compile"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  latestStats = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">if</span> (opts.log) opts.log(<span class="string">"webpack building..."</span>);</span><br><span class="line">  eventStream.publish(&#123;<span class="attr">action</span>: <span class="string">"building"</span>&#125;);</span><br><span class="line">&#125;);</span><br><span class="line">compiler.plugin(<span class="string">"done"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">statsResult</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// Keep hold of latest stats so they can be propagated to new clients</span></span><br><span class="line">  latestStats = statsResult;</span><br><span class="line">  publishStats(<span class="string">"built"</span>, latestStats, eventStream, opts.log);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>åœ¨ middleware.js æ–‡ä»¶ä¸­ï¼Œä¸»è¦åšçš„äº‹æƒ…å°±æ˜¯ç›‘å¬ webpack çš„ compile ä»»åŠ¡ç‚¹å’Œ done ä»»åŠ¡ç‚¹ã€‚åœ¨ webpack å¼€å§‹ç¼–è¯‘æ—¶ï¼Œå‘æµè§ˆå™¨ç«¯ publish ä¸€ä¸ª building action ï¼Œåœ¨ webpack ç¼–è¯‘æ‰“åŒ…å®Œæˆæ—¶ï¼Œpublish ä¸€ä¸ª built action å¹¶å°†å®Œæˆçš„ statsResult ä½œä¸ºå‚æ•°è°ƒç”¨ publishStats å‡½æ•°ï¼Œè¯¥å‡½æ•°å†…å®¹å¦‚ä¸‹ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">publishStats</span>(<span class="params">action, statsResult, eventStream, log</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// For multi-compiler, stats will be an object with a 'children' array of stats</span></span><br><span class="line">  <span class="keyword">var</span> bundles = extractBundles(statsResult.toJson(&#123; <span class="attr">errorDetails</span>: <span class="literal">false</span> &#125;));</span><br><span class="line">  bundles.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">stats</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (log) &#123;</span><br><span class="line">      log(<span class="string">"webpack built "</span> + (stats.name ? stats.name + <span class="string">" "</span> : <span class="string">""</span>) +</span><br><span class="line">        stats.hash + <span class="string">" in "</span> + stats.time + <span class="string">"ms"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    eventStream.publish(&#123;</span><br><span class="line">      name: stats.name,</span><br><span class="line">      action: action,</span><br><span class="line">      time: stats.time,</span><br><span class="line">      hash: stats.hash,</span><br><span class="line">      warnings: stats.warnings || [],</span><br><span class="line">      errors: stats.errors || [],</span><br><span class="line">      modules: buildModuleMap(stats.modules)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>é¦–å…ˆé€šè¿‡ extractBundles å‡½æ•°æŠŠ statsResult ä¸­çš„æ¨¡å—è¿›è¡Œæ•°ç»„åŒ–ï¼Œç„¶åéå†æ•°ç»„ä¸­æ¯ä¸ªæ›´æ–°çš„æ¨¡å— publish åˆ°æµè§ˆå™¨ç«¯ã€‚</p>
<h3 id="ç”Ÿäº§ç¯å¢ƒ"><a href="#ç”Ÿäº§ç¯å¢ƒ" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒ"></a>ç”Ÿäº§ç¯å¢ƒ</h3><h4 id="é…ç½®CommonsChunkPlugin"><a href="#é…ç½®CommonsChunkPlugin" class="headerlink" title="é…ç½®CommonsChunkPlugin"></a>é…ç½®CommonsChunkPlugin</h4><p>CommonsChunkPluginæ’ä»¶çš„åŠŸèƒ½æ˜¯åœ¨å¤šå…¥å£çš„æƒ…å†µä¸‹å°†æ‰“åŒ…è¿‡ç¨‹ä¸­çš„å…¬å…±æ¨¡å—æŠ½ç¦»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œä»¥å‡å°æœ€å bundle æ–‡ä»¶çš„ä½“ç§¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">plugins: [</span><br><span class="line">  <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">    name: <span class="string">'vendor'</span>,</span><br><span class="line">    minChunks: <span class="function"><span class="keyword">function</span> (<span class="params">module, count</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="built_in">module</span>.resource &amp;&amp;</span><br><span class="line">        /\.js$/.test(<span class="built_in">module</span>.resource) &amp;&amp;</span><br><span class="line">        <span class="built_in">module</span>.resource.indexOf(</span><br><span class="line">          path.join(__dirname, <span class="string">'../node_modules'</span>)</span><br><span class="line">        ) === <span class="number">0</span></span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">	<span class="comment">//å°†node_moduleé‡Œæ‰€æœ‰çš„æ¨¡å—éƒ½æå–åˆ°vendor.jsä¸­</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="åŠ é€Ÿæ–‡ä»¶æœç´¢"><a href="#åŠ é€Ÿæ–‡ä»¶æœç´¢" class="headerlink" title="åŠ é€Ÿæ–‡ä»¶æœç´¢"></a>åŠ é€Ÿæ–‡ä»¶æœç´¢</h4><h5 id="é…ç½®-resolve-modules"><a href="#é…ç½®-resolve-modules" class="headerlink" title="é…ç½® resolve.modules"></a>é…ç½® resolve.modules</h5><p>Webpackçš„ resolve.modules é…ç½®æ¨¡å—åº“ï¼ˆå³ node_modulesï¼‰æ‰€åœ¨çš„ä½ç½®ï¼Œåœ¨ js é‡Œå‡ºç°ç±»ä¼¼ import â€˜vueâ€™ è¿™æ ·å³ä¸æ˜¯ç›¸å¯¹ä¹Ÿä¸æ˜¯ç»å¯¹è·¯å¾„çš„å†™æ³•æ—¶ï¼Œä¼šå» node_modules ç›®å½•ä¸‹æ‰¾ã€‚ä½†æ˜¯é»˜è®¤çš„é…ç½®ï¼Œä¼šé‡‡ç”¨å‘ä¸Šé€’å½’æœç´¢çš„æ–¹å¼å»å¯»æ‰¾ï¼Œä½†é€šå¸¸é¡¹ç›®ç›®å½•é‡Œåªæœ‰ä¸€ä¸ª node_modulesï¼Œä¸”æ˜¯åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œä¸ºäº†å‡å°‘æœç´¢èŒƒå›´ï¼Œå¯ä»¥ç›´æ¥å†™æ˜ node_modules çš„å…¨è·¯å¾„ï¼Œ src ç›®å½•åŒç†ï¼›</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span> (<span class="params">dir</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> path.join(__dirname, <span class="string">'..'</span>, dir)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    extensions: [<span class="string">'.js'</span>, <span class="string">'.vue'</span>, <span class="string">'.json'</span>],</span><br><span class="line">    modules: [</span><br><span class="line">      resolve(<span class="string">'src'</span>),</span><br><span class="line">      resolve(<span class="string">'node_modules'</span>)</span><br><span class="line">    ],</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">'vue$'</span>: <span class="string">'vue/dist/vue.common.js'</span>,</span><br><span class="line">      <span class="string">'src'</span>: resolve(<span class="string">'src'</span>),</span><br><span class="line">      <span class="string">'assets'</span>: resolve(<span class="string">'src/assets'</span>),</span><br><span class="line">      <span class="string">'components'</span>: resolve(<span class="string">'src/components'</span>),</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">      <span class="string">'store'</span>: resolve(<span class="string">'src/store'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="è®¾ç½®-test-amp-include-amp-exclude"><a href="#è®¾ç½®-test-amp-include-amp-exclude" class="headerlink" title="è®¾ç½® test &amp; include &amp; exclude"></a>è®¾ç½® test &amp; include &amp; exclude</h5><p>å¯¹äºincludeï¼Œæ›´ç²¾ç¡®æŒ‡å®šè¦å¤„ç†çš„ç›®å½•ï¼Œè¿™å¯ä»¥å‡å°‘ä¸å¿…è¦çš„éå†ï¼Œä»è€Œå‡å°‘æ€§èƒ½æŸå¤±ã€‚åŒæ ·ï¼Œå¯¹äºå·²ç»æ˜ç¡®çŸ¥é“çš„ï¼Œä¸éœ€è¦å¤„ç†çš„ç›®å½•ï¼Œåˆ™åº”è¯¥äºˆä»¥æ’é™¤ï¼Œä»è€Œè¿›ä¸€æ­¥æå‡æ€§èƒ½ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªç¬¬ä¸‰æ–¹ç»„ä»¶çš„å¼•ç”¨ï¼Œå®ƒè‚¯å®šä½äº node_modulesï¼Œé€šå¸¸å®ƒå°†æœ‰ä¸€ä¸ª src å’Œä¸€ä¸ª dist ç›®å½•ã€‚å¦‚æœé…ç½® Webpack æ¥æ’é™¤ node_modulesï¼Œé‚£ä¹ˆå®ƒå°†ä» dist å·²ç»ç¼–è¯‘çš„ç›®å½•ä¸­è·å–æ–‡ä»¶ã€‚å¦åˆ™ä¼šå†æ¬¡ç¼–è¯‘å®ƒä»¬ã€‚æ•…è€Œï¼Œåˆç†çš„è®¾ç½® include &amp; excludeï¼Œå°†ä¼šæå¤§åœ°æå‡ Webpack æ‰“åŒ…ä¼˜åŒ–é€Ÿåº¦</p>
<h4 id="ä½¿ç”¨å¹¶è¡Œå‹ç¼©æ’ä»¶-webpack-parallel-uglify-plugin"><a href="#ä½¿ç”¨å¹¶è¡Œå‹ç¼©æ’ä»¶-webpack-parallel-uglify-plugin" class="headerlink" title="ä½¿ç”¨å¹¶è¡Œå‹ç¼©æ’ä»¶ webpack-parallel-uglify-plugin"></a>ä½¿ç”¨å¹¶è¡Œå‹ç¼©æ’ä»¶ webpack-parallel-uglify-plugin</h4><p>webpackè‡ªå¸¦çš„jså‹ç¼©æ’ä»¶æ˜¯UglifyJsPluginï¼Œè¯¥å‹ç¼©æ’ä»¶æ˜¯å•çº¿ç¨‹å‹ç¼©ï¼Œé€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œwebpack-parallel-uglify-plugin è¿™ä¸ªæ’ä»¶å¯ä»¥å¹¶è¡Œè¿è¡Œå¤šä¸ª UglifyJs æ’ä»¶ï¼Œå……åˆ†åˆ©ç”¨ CPU èµ„æºã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> ParallelUglifyPlugin(&#123;</span><br><span class="line">  uglifyJS:&#123;</span><br><span class="line">    output: &#123;</span><br><span class="line">      comments: <span class="literal">false</span></span><br><span class="line">    &#125;,</span><br><span class="line">    compress: &#123;</span><br><span class="line">      warnings: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ›¿æ¢å‹ç¼©æ’ä»¶å‰å wmda é¡¹ç›®çš„æ‰“åŒ…æ—¶é—´ç¼©çŸ­äº†8så·¦å³ã€‚</p>
<h4 id="é…ç½®externals"><a href="#é…ç½®externals" class="headerlink" title="é…ç½®externals"></a>é…ç½®externals</h4><p>Webpack å¯ä»¥é…ç½® externals å‚æ•°æ¥å°†ä¾èµ–çš„åº“æŒ‡å‘å…¨å±€å˜é‡ï¼Œä»è€Œä¸å†æ‰“åŒ…è¿™ä¸ªåº“ï¼Œç„¶åç”¨cdnå°†è¯¥åº“å¼•å…¥è‡³å…¨å±€ã€‚</p>
<p>ä¾‹å¦‚ï¼Œé¡¹ç›®ä¸­ import äº† react åº“ï¼Œæ­¤æ—¶å¯ä»¥é…ç½® externals å°† react æŒ‡å‘ window.React è¿™ä¸ªå…¨å±€å˜é‡ï¼Œç„¶åç”¨ script æ ‡ç­¾å°† react.min.js å¼•å…¥é¡µé¢ä¿è¯ window.React å­˜åœ¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    externals: &#123;</span><br><span class="line">        <span class="string">'react'</span>: <span class="string">'window.React'</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å…¶å®ƒé…ç½®å¿½ç•¥...... </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ webpack å°†ä¸å†æ‰“åŒ… react åº“ï¼Œæ‰€ä»¥æ‰“åŒ…é€Ÿåº¦å¤§å¹…æå‡ã€‚ä½†æ˜¯é—®é¢˜æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œå¦‚æœæ­¤æ—¶æˆ‘ä»¬åˆ import äº†ä¸€ä¸ª react å­åº“ react-bootstrap åˆ°é¡¹ç›®ä¸­ï¼Œä¼šå‘ç° webpack åˆæŠŠ react æ•´ä¸ªåº“ç»™æ‰“åŒ…äº†ã€‚</p>
<p>åŸå› æ˜¯ï¼Œæ‰“åŒ… react-bootstrap æ—¶ï¼Œè¯¥åº“ä¾èµ–äº† react ä¸»åº“ï¼Œwebpackæ­¤æ—¶ä¸çŸ¥é“è¿™ä¸ªä¾èµ–å…¥å£å°±æ˜¯ externals ä¸­é…ç½®çš„ react æ¨¡å—ï¼Œæ‰€ä»¥åˆå‚»å‚»çš„æ‰“åŒ…äº†ä¸€éã€‚å¯èƒ½ä½ ä¼šè¯´ï¼ŒæŠŠ react-bootstrap è¿™ä¸ªåº“ä¹Ÿé…ç½®åˆ° externals é‡Œä¸å°±è¡Œäº†å—ï¼Ÿä½†é—®é¢˜å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“éƒ½æä¾›äº†ç”¨äºç”Ÿäº§ç¯å¢ƒçš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰æä¾› react-bootstrap.min.js è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p>è§£å†³æ–¹æ³•å°±æ˜¯ä½¿ç”¨ä¸‹é¢è¯´çš„ DllPlugin å’Œ DllReferencePlugin ã€‚</p>
<h4 id="ä½¿ç”¨DllPluginå’ŒDllReferencePlugin"><a href="#ä½¿ç”¨DllPluginå’ŒDllReferencePlugin" class="headerlink" title="ä½¿ç”¨DllPluginå’ŒDllReferencePlugin"></a>ä½¿ç”¨DllPluginå’ŒDllReferencePlugin</h4><p>dllï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰æ˜¯ window ç³»ç»Ÿä¸­ä¸€ç§å¸¸è§çš„æ€æƒ³ã€‚<strong>ä¸€ä¸ª dll æ–‡ä»¶ï¼Œå°±æ˜¯ä¸€ä¸ªä¾èµ–åº“ï¼Œå®ƒæœ¬èº«ä¸èƒ½è¿è¡Œä¹Ÿä¸ä¼šä¿®æ”¹ï¼Œæ˜¯ç»™å…¶ä»–æ¨¡å—æˆ–è€…ä¸šåŠ¡ä»£ç å¼•ç”¨çš„</strong>ã€‚</p>
<p>DllPlugin å’Œ DllReferencePlugin éœ€è¦é…åˆä½¿ç”¨ï¼Œå®ƒä»¬æä¾›äº†ä¸€ç§ç”¨æ‹†åˆ†è½¯ä»¶åŒ…é¢„æ„å»ºçš„æ‰“åŒ…æ–¹æ³•ã€‚å…¶åŸç†æ˜¯ï¼Œå°†æŒ‡å®šçš„ç¬¬ä¸‰æ–¹NPMåŒ…æ¨¡å—æå‰æ„å»ºï¼Œç„¶åé€šè¿‡é¡µé¢å¼•å…¥ã€‚è¿™ä¸ä»…èƒ½å¤Ÿä½¿å¾—æ‰“åŒ…åçš„å…¬å…±æ¨¡å— vendor.js æ–‡ä»¶ä½“ç§¯å¤§å¹…åº¦å‡å°ï¼ŒåŒæ—¶ï¼Œä¹Ÿæå¤§çš„æé«˜äº†æ„å»ºé€Ÿåº¦ã€‚</p>
<p><strong>webpack.dll.conf.js:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    vendor: [</span><br><span class="line">      <span class="string">'babel-polyfill'</span>,</span><br><span class="line">      <span class="string">'axios'</span>,</span><br><span class="line">      <span class="string">'vue-router'</span>,</span><br><span class="line">      <span class="string">'vuex'</span>,</span><br><span class="line">      <span class="string">'element-ui'</span>,</span><br><span class="line">      <span class="string">'highcharts'</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'../static/js'</span>),</span><br><span class="line">    filename: <span class="string">'[name].dll.js'</span>,</span><br><span class="line">    library: <span class="string">'[name]_library'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">      path: path.resolve(<span class="string">'../static'</span>, <span class="string">'[name]-manifest.json'</span>),</span><br><span class="line">      name: <span class="string">'[name]_library'</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(&#123;</span><br><span class="line">      compress: &#123;</span><br><span class="line">        warnings: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>webpack.prod.conf.js:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">	manifest: <span class="built_in">require</span>(<span class="string">'../static/vendor-manifest.json'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><strong>package.json</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">	<span class="string">"build:dll"</span>: <span class="string">"webpack --config build/webpack.dll.conf.js"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œnpm run build:dllï¼Œä¼šåœ¨staticæ–‡ä»¶å¤¹ä¸­ç”Ÿæˆ<strong>vendor-manifest.json</strong>ä»¥åŠ<strong>vendor.dll.js</strong>æ–‡ä»¶ï¼ŒæŒ‡å®šçš„ç¬¬ä¸‰æ–¹npmæ¨¡å—å°±æå‰æ„å»ºåœ¨äº†<strong>vendor.dll.js</strong>ä¸­ï¼Œæ­¤æ—¶åœ¨htmlä¸­å¼•ç”¨è¯¥æ–‡ä»¶ï¼Œå†æ‰§è¡Œnpm run buildå»æ‰“åŒ…é¡¹ç›®ï¼Œæ„å»ºçš„æ—¶é—´ç»æµ‹è¯•å°†ç¼©çŸ­20så·¦å³ã€‚æ‰“åŒ…ådistä¸­çš„<strong>vendor.js</strong>æ–‡ä»¶ä½“ç§¯ä¹Ÿç”±600+kbç¼©å°è‡³100+kbã€‚</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/webpack/" rel="tag"># webpack</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/10/31/passportåˆæ­¥è°ƒç ”/" rel="next" title="passportè°ƒç ”ï¼ˆç™¾åº¦ã€äº¬ä¸œï¼‰">
                <i class="fa fa-chevron-left"></i> passportè°ƒç ”ï¼ˆç™¾åº¦ã€äº¬ä¸œï¼‰
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/03/cache_2/" rel="prev" title="æµè§ˆå™¨ç¼“å­˜é—®é¢˜è¡¥å……">
                æµè§ˆå™¨ç¼“å­˜é—®é¢˜è¡¥å…… <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Ztt</p>
              <p class="site-description motion-element" itemprop="description">è®°å½•å­¦ä¹ æˆé•¿</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#webpackç›¸å…³åˆ†äº«"><span class="nav-number">1.</span> <span class="nav-text">webpackç›¸å…³åˆ†äº«</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#webpackå¸¸è§„é…ç½®"><span class="nav-number">1.1.</span> <span class="nav-text">webpackå¸¸è§„é…ç½®</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#webpackä¼˜åŒ–æ”»ç•¥"><span class="nav-number">1.2.</span> <span class="nav-text">webpackä¼˜åŒ–æ”»ç•¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¼€å‘ç¯å¢ƒ"><span class="nav-number">1.2.1.</span> <span class="nav-text">å¼€å‘ç¯å¢ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HMRä½¿ç”¨æ–¹å¼"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">HMRä½¿ç”¨æ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æºç åˆ†æ"><span class="nav-number">1.2.1.2.</span> <span class="nav-text">æºç åˆ†æ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç”Ÿäº§ç¯å¢ƒ"><span class="nav-number">1.2.2.</span> <span class="nav-text">ç”Ÿäº§ç¯å¢ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®CommonsChunkPlugin"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">é…ç½®CommonsChunkPlugin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŠ é€Ÿæ–‡ä»¶æœç´¢"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">åŠ é€Ÿæ–‡ä»¶æœç´¢</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#é…ç½®-resolve-modules"><span class="nav-number">1.2.2.2.1.</span> <span class="nav-text">é…ç½® resolve.modules</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#è®¾ç½®-test-amp-include-amp-exclude"><span class="nav-number">1.2.2.2.2.</span> <span class="nav-text">è®¾ç½® test &amp; include &amp; exclude</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨å¹¶è¡Œå‹ç¼©æ’ä»¶-webpack-parallel-uglify-plugin"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">ä½¿ç”¨å¹¶è¡Œå‹ç¼©æ’ä»¶ webpack-parallel-uglify-plugin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é…ç½®externals"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">é…ç½®externals</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ä½¿ç”¨DllPluginå’ŒDllReferencePlugin"><span class="nav-number">1.2.2.5.</span> <span class="nav-text">ä½¿ç”¨DllPluginå’ŒDllReferencePlugin</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ztt</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
